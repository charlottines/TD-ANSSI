{% extends "analyse/base.html" %}

{% block content %}
<div class="container mt-5 text-center">

  <h1 class="display-5 mb-4">
    <span style="font-size: 2.5rem;">ğŸ””</span> VulnÃ©rabilitÃ©s Critiques DÃ©tectÃ©es
  </h1>

  <form method="POST" action="{% url 'trigger_alerts' %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger btn-lg shadow px-4 py-2 mb-5">
       DÃ©clencher les alertes critiques
    </button>
  </form>

  {% if messages %}
    <div class="alert alert-warning text-start" role="alert">
      <h5 class="mb-3"> RÃ©sumÃ© des alertes dÃ©tectÃ©es :</h5>
      {% for msg in messages %}
        <div class="alert alert-light border-start border-danger border-4 p-3 mb-3" style="font-family: monospace;">
          <pre class="m-0">{{ msg }}</pre>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info d-inline-flex align-items-center justify-content-center px-4 py-3 shadow-sm border rounded">
       <span class="ms-2">Aucune vulnÃ©rabilitÃ© critique dÃ©tectÃ©e.</span>
    </div>
  {% endif %}

</div>

<div class="alert alert-info mt-5 shadow-sm border border-primary-subtle" style="max-width: 850px; margin: auto; background-color: #e8f4fd;">
  <h5 class="fw-bold mb-3">
     Astuce : ProblÃ¨me dâ€™envoi dâ€™email ?
  </h5>
  <p class="mb-2">
    VÃ©rifiez que lâ€™adresse et le mot de passe de lâ€™expÃ©diteur sont correctement renseignÃ©s dans 
    <code><strong>views.py</strong></code> (vers la ligne <strong>102</strong>) :
  </p>
  <ul class="mb-3">
    <li><code>from_email = "votre_email@gmail.com"</code></li>
    <li><code>password = "mot_de_passe_application"</code></li>
  </ul>
  <p>
    Pour Gmail, <strong>gÃ©nÃ©rez un mot de passe dâ€™application</strong> depuis 
    <a href="https://myaccount.google.com/apppasswords" target="_blank" class="text-decoration-underline fw-semibold">
      cette page
    </a>.
  </p>
</div>
{% endblock %}